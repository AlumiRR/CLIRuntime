# CLIRuntime
Простой daemon для Linux, общающийся с клиентом по UDP

Использованы библеотеки:

<https://github.com/baderouaich/daemonpp>

## Сборка

Для сборки Debug

```
$ cmake . -DCMAKE_BUILD_TYPE=Debug

$ make
```

Для сборки Release

```
$ cmake . -DCMAKE_BUILD_TYPE=Release

$ make
```

Результат будет находится в директории bin

## Установка и удаление

Утилиту можно запустить напрямую сразу после сборки через бинарник или установить как утилиту bash + сервис работающий при запуске системы и управляемый из sysctl

```
$ sudo make install
```

После установки для запуска программы как сервиса

```
$ sudo systemctl start cliruntime
```

Для автоматического запуска со стартом системы
```
$ sudo systemctl enable cliruntime
```

Удалить можно через make
```
$ sudo make uninstall
```

## Использование

Для просмотра версии
```
$ cliruntime -v
```

Для запуска сервера
```
$ cliruntime --run --config /path/to/cliruntime.conf
```
Сервер прослушивает порт указанный в конфиге. Возможен запуск без конфига, тогда порт по умолчанию будет 7070.
Сервер пишет логи в `/var/log/syslog`. Их также можно посмотреть через `sysctl status` если программа запущена как сервис.
Каждые 30 секунд сервер пишет uptime системы в лог.

Для отправки команд
```
$ cliruntime -p <порт> --cmd="<команда>"
```

### Возможные команды

`--cmd="stop"` для остановки сервиса

`--cmd="dir <директория>" | --cmd="listen <директория>"` для получения списка файлов